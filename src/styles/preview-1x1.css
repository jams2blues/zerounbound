/*Developed by @jams2blues
  File: src/styles/preview-1x1.css
  Rev:  r47
  Summary: Enforce perfect 1:1 media fit, zero rounding, and no bleed.
           Add robust pixelated upscaling (utility + tile-scoped). */

.preview-1x1 {
  position: relative;
  aspect-ratio: 1 / 1;
  /* Ensure square preview background is solid; no page bleed. */
  background: var(--zu-bg-dim, #111);
  overflow: hidden; /* crop any stray overflow */
  border-radius: 0 !important; /* absolutely no rounding */
}

/* Make all media inside the 1x1 tile snap by the longest edge.
   One dimension will equal the tile edge; the other will letterbox. */
.preview-1x1 img,
.preview-1x1 video,
.preview-1x1 canvas,
.preview-1x1 svg,
.preview-1x1 object,
.preview-1x1 iframe,
.preview-1x1 model-viewer {
  display: block;
  width: 100% !important;
  height: 100% !important;
  object-fit: contain !important;     /* longest edge snaps to edges */
  object-position: center center !important;
  border-radius: 0 !important;        /* remove any rounding from media */
  background: transparent;
}

/* Pixel-perfect upscaling for raster media inside tiles */
.preview-1x1 img,
.preview-1x1 canvas {
  /* Modern and fallbacks for widest browser coverage */
  image-rendering: optimizeSpeed;             /* legacy */
  image-rendering: -moz-crisp-edges;          /* FF */
  image-rendering: -o-crisp-edges;            /* Opera */
  image-rendering: -webkit-optimize-contrast; /* Safari-ish */
  image-rendering: crisp-edges;               /* CSS4 */
  image-rendering: pixelated;                 /* modern */
}

/* RenderMedia wraps <video> in a div; force the wrapper to fill the tile. */
.preview-1x1 > div[data-zu-media="video"] {
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
  border-radius: 0 !important;
}

/* Keep the fullscreen helper inside the tile corner without rounding. */
.preview-1x1 button[title="Fullscreen"] {
  border-radius: 0 !important;
}

/* Global utility to force crisp nearest-neighbour raster upscaling anywhere. */
.zu-pixelated,
img.zu-pixelated,
canvas.zu-pixelated {
  image-rendering: optimizeSpeed;
  image-rendering: -moz-crisp-edges;
  image-rendering: -o-crisp-edges;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
  image-rendering: pixelated;
}

/* What changed & why: Lock 1x1 tiles to true 'contain', fill wrappers, and
   hard-zero any rounding so media edges snap cleanly to the square. Also add
   robust pixelated upscaling for raster media across browsers, via both scoped
   tile rules and a reusable .zu-pixelated utility class. */

